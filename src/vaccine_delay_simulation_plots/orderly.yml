script: script.R

parameters:
  date_of_fits: ~
  vaccine_efficacy_alteration:
    default: false
  short_run: ~
  n_par: ~
  days_between_doses:
    default: FALSE

packages:
  - tidyr
  - ggplot2
  - dplyr
  - knitr
  - raster
  - scales
  - RColorBrewer
  - ggrepel
  - cowplot
  - forcats

artefacts:

  - data:
      description: Figures
      filenames:
        - figs/f1_trajectories.png
        - figs/f1_trajectories.tiff
        - figs/f1_trajectories.pdf
        - figs/f2_protection.png
        - figs/f2_protection.tiff
        - figs/f2_protection.pdf
        - figs/f2_collapsed_protection.pdf
        - figs/f2_collapsed_protection.png
        - figs/f2_collapsed_protection.tiff
        - figs/f3_hosps.png
        - figs/f3_hosps.tiff
        - figs/f3_hosps.pdf
        - figs/f3_SI_stacked.png
        - figs/f3_SI_proportion.png
        - figs/f3_hosp_distribution.png
        - figs/f3_hosps_collapsed.pdf
        - figs/f3_hosps_collapsed.png
        - figs/f3_hosps_collapsed.tiff
        - figs/f4.png
        - figs/f4.tiff
        - figs/f4.pdf
        - figs/f5_Alpha_VE.png
        - figs/f5_Alpha_VE.pdf
        - figs/f5_Alpha_VE.tiff
        - figs/f6a_sensitivities.pdf
        - figs/f6a_sensitivities.png
        - figs/f6a_sensitivities.tiff
        - figs/f6b_alpha_sensitivities.pdf
        - figs/f6b_alpha_sensitivities.png
        - figs/f6b_alpha_sensitivities.tiff

sources:
  - Fig1_support.R
  - Fig2_support.R
  - Fig3_support.R
  - Fig4_support.R
  - Fig5_support.R
  - Fig6_support.R

resources:
 - Delta_emergence_data.csv
 - vaccine_efficacy_delta_sensitivities.csv
 - vaccine_efficacy_alpha.csv
 - estimated_admissions_by_age.csv
 - nation_2022_05_03.csv

global_resources:
  global_util.R: rtm_inference/util_new.R

depends:
  - vaccine_delay_simulation:
      id: latest(parameter:date_of_fits == date_of_fits && parameter:short_run == short_run && parameter:n_par == n_par && parameter:days_between_doses == days_between_doses && parameter:vaccine_efficacy_alteration == vaccine_efficacy_alteration)
      use:
        simulation.rds: outputs/summary.rds
        simulation_by_age.rds: outputs/summary_tidy_state_by_age.rds
        fit_trajectories.rds: outputs/summary_restart.rds
        combined.rds: combined.rds
        p_C_and_H.rds: outputs/p_C_and_H.rds
        Counterfactual_vaccine_schedule.rds: outputs/Counterfactual_vaccine_schedule.rds
        Real_vaccine_schedule.rds: outputs/Real_vaccine_schedule.rds
