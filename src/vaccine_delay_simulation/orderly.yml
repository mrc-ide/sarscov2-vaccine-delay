script: script.R

parameters:
  # control for the simulation task itself
  n_par: ~
  days_between_doses:
    default: false
  vaccine_efficacy_alteration:
    default: false
  mean_waning_time:
    default: false
  # pass through to the select the parent fit
  date_of_fits: ~
  short_run: ~
  debug:
    default: false

packages:
  - tidyr
  - magrittr
  - ggplot2
  - tdigest
  - distr6
  - viridis
  - dplyr
  - spimalot
  - cowplot

artefacts:
  - data:
      description: Overall data for the uk
      filenames:
        - outputs/summary.rds
        - outputs/summary_restart.rds
        - outputs/summary_tidy_state_by_age.rds
        - combined.rds
        - rt_future.csv
        - outputs/Real_vaccine_schedule.rds
        - outputs/Counterfactual_vaccine_schedule.rds
        - outputs/p_C_and_H.rds
  - data:
      description: check Rt profile over time
      filenames:
        - figs/check_Rt_all.pdf
        - figs/check_Rt_avg.pdf
        - figs/check_states.pdf
        - figs/check_states_by_age.pdf
        - figs/check_doses_by_age.pdf
        - figs/check_daily_doses.pdf
        - figs/check_proportion_doses.pdf
        - figs/check_daily_infections.pdf


resources:
  - template_combined.xlsx
  - vaccine_data/vaccine_efficacy_alpha.csv
  - vaccine_data/vaccine_efficacy_delta.csv
  - vaccine_data/data_vaccination.csv

sources:
  - support.R

global_resources:
  global_util.R: rtm_inference/util_new.R
  global_pars.R: rtm_inference/pars.R
  global_vaccine.R: rtm_inference/vaccine.R

depends:
  - vaccine_delay_fits_combined:
      id: latest(parameter:deterministic == FALSE && parameter:short_run == short_run)
      use:
        combined.rds: outputs/combined.rds
  - vaccine_delay_simulation_parameters:
      id: latest(parameter:date_of_fits == date_of_fits)
      use:
        spim_parameters_simulate.rds: spim_parameters_simulate.rds
